<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Velocity Drive: Synthwave</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
  margin: 0;
  background: radial-gradient(#0b0020, #000);
  font-family: system-ui, Arial;
  color: white;
  overflow: hidden;
}

canvas {
  display: block;
  margin: auto;
}

/* UI SCREENS */
.screen {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  background: radial-gradient(#120030, #000);
  z-index: 10;
}

.screen h1 {
  font-size: 48px;
  margin-bottom: 10px;
  text-shadow: 0 0 25px #ff00ff;
}

.screen p {
  opacity: 0.8;
}

button {
  margin-top: 12px;
  padding: 12px 26px;
  font-size: 16px;
  font-weight: 700;
  border: none;
  border-radius: 12px;
  background: linear-gradient(135deg, #ff00ff, #00f6ff);
  color: black;
  cursor: pointer;
  box-shadow: 0 0 25px #ff00ff;
}
</style>
</head>

<body>

<!-- MAIN MENU -->
<div id="menu" class="screen" style="display:flex">
  <h1>VELOCITY DRIVE</h1>
  <p>S Y N T H W A V E</p>
  <button onclick="startGame()">START</button>
</div>

<!-- CRASH SCREEN -->
<div id="crash" class="screen">
  <h1>CRASHED</h1>
  <p>Distance: <span id="finalDist">0</span> ft</p>
  <button onclick="restart()">Restart</button>
  <button onclick="backToMenu()">Main Menu</button>
</div>

<canvas id="game" width="800" height="600"></canvas>

<script>
/* ===== CANVAS ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ===== GAME STATE ===== */
let state = "menu";

/* ===== INPUT ===== */
const keys = {};
addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

/* ===== PLAYER ===== */
let player, distance, speed;

/* ===== TRAFFIC ===== */
let enemies = [];

/* ===== START ===== */
function startGame() {
  menu.style.display = "none";
  crash.style.display = "none";
  state = "game";

  player = { x: 400, vx: 0 };
  speed = 0;
  distance = 0;
  enemies = [];
}

/* ===== RESTART ===== */
function restart() {
  startGame();
}

/* ===== MENU ===== */
function backToMenu() {
  crash.style.display = "none";
  menu.style.display = "flex";
  state = "menu";
}

/* ===== SPAWN ENEMIES ===== */
function spawnEnemy() {
  enemies.push({
    x: 200 + Math.random() * 400,
    y: -100
  });
}
setInterval(() => {
  if (state === "game") spawnEnemy();
}, 900);

/* ===== DRAW BACKGROUND ===== */
function drawBackground() {
  // Sky
  const g = ctx.createLinearGradient(0,0,0,600);
  g.addColorStop(0,"#20004d");
  g.addColorStop(1,"#000");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,800,600);

  // Sun
  ctx.beginPath();
  ctx.arc(400,200,80,0,Math.PI*2);
  ctx.fillStyle = "#ff3cac";
  ctx.shadowColor = "#ff3cac";
  ctx.shadowBlur = 30;
  ctx.fill();
  ctx.shadowBlur = 0;

  // Grid
  ctx.strokeStyle = "#7f00ff";
  for(let i=0;i<20;i++){
    ctx.beginPath();
    ctx.moveTo(0,400+i*20);
    ctx.lineTo(800,400+i*20);
    ctx.stroke();
  }
  for(let i=0;i<40;i++){
    ctx.beginPath();
    ctx.moveTo(i*20,400);
    ctx.lineTo(400,600);
    ctx.stroke();
  }
}

/* ===== GAME LOOP ===== */
function loop() {
  requestAnimationFrame(loop);
  if (state !== "game") return;

  drawBackground();

  // Controls
  if (keys["w"] || keys["arrowup"]) speed += 0.15;
  if (keys["s"] || keys["arrowdown"]) speed -= 0.2;
  speed *= 0.98;
  speed = Math.max(0, Math.min(12, speed));

  if (keys["a"] || keys["arrowleft"]) player.vx -= 0.15;
  if (keys["d"] || keys["arrowright"]) player.vx += 0.15;
  player.vx *= 0.9;
  player.x += player.vx * 20;
  player.x = Math.max(200, Math.min(600, player.x));

  // Player car
  ctx.fillStyle = "#00f6ff";
  ctx.shadowColor = "#00f6ff";
  ctx.shadowBlur = 20;
  ctx.fillRect(player.x-18,460,36,80);
  ctx.shadowBlur = 0;

  // Enemies
  enemies.forEach(e => {
    e.y += speed + 4;
    ctx.fillStyle = "#ff004c";
    ctx.fillRect(e.x-18,e.y,36,80);

    if (Math.abs(e.x-player.x)<30 && Math.abs(e.y-460)<60) crashGame();
  });
  enemies = enemies.filter(e => e.y < 700);

  // Distance
  distance += speed;
  ctx.fillStyle = "#fff";
  ctx.fillText("Distance: " + Math.floor(distance) + " ft", 20, 30);
}

/* ===== CRASH ===== */
function crashGame() {
  state = "crash";
  finalDist.textContent = Math.floor(distance);
  crash.style.display = "flex";
}

loop();
</script>

</body>
</html>
